
# Overview

Servmon can be regarded as relatively straightforward box whereby all exploits can be found/referenced from exploitDB and there is no custom exploitation required for the box.

The vulnerabilities exploited in this box are as follows:
<ol type="1">
  <li>NVMS 1000 Directory Traversal</li>
  <li>NSClient++ 0.5.2.35</li>
</ol>

# Discovery 
Starting with a standard nmap command, using default scripts and enumerating versions, resulted in the following output: 
<img src="https://private-user-images.githubusercontent.com/58163840/309442175-b4918205-a234-4e76-9b5d-580498d9244a.jpeg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzUtYjQ5MTgyMDUtYTIzNC00ZTc2LTliNWQtNTgwNDk4ZDkyNDRhLmpwZWc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMzAyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDMwMlQwNTA3MzVaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yMTBiNTA3YTBjOGI2OWE0YjM0Mzc3ZmY0YTFkY2E1Njg1NWU5OTY4MGQzNDIzZWExOThhZGI5NGM3OTQ5MjBhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.KCjei5DGZG5FFXaxx990nQvQ8hrLgvk0w-X43wSgXiI" name="nmap">

# Obtaining user access
From the nmap results, it can be seen that the ftp port 21, allows anonymous access to the box. 
By anonymously accessing the ftp server, it was found that under the folder /users/Nadine, there was a confidential.txt file which revealed that there were password files in Nathan's Desktop folder. 

<img src="https://private-user-images.githubusercontent.com/58163840/309442169-4a6221f1-904b-4248-93df-be5e214efaa5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjktNGE2MjIxZjEtOTA0Yi00MjQ4LTkzZGYtYmU1ZTIxNGVmYWE1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJhMzU1MTk4YWRmYjM1NjNlN2I3YmRkODA0Yzk3NDJkMTE4YjdiZjM1YzBhMWMzNjhlZTBlZmRmNTViMTc1MjMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.CWu2JttH_pPOFB2Pzw-dHgywiLEMe0wkqv0a81vts38" name="ftp">

<img src="https://private-user-images.githubusercontent.com/58163840/309442162-8398d1f6-6e10-40af-82f5-7736bddb7d1e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjItODM5OGQxZjYtNmUxMC00MGFmLTgyZjUtNzczNmJkZGI3ZDFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ5YzJjNTQ3ZTA0MjIyNDI1YjYwMzQ5MWY5NGM2ZDU1YmZjYmQ4MGYzMzg2NDZjN2NmNzAzYzIwMGM3MzdhN2ImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.m8NiVR1G3MXd8bnnZpMg4s7Myr1RAwCeVPAQU20KQZ4" name="confidential">


Also, by conducting further emuneration of the website, it was foudn that the website uses NVMS1000 which has an existing directory traversal vulnerability listed in:

<a href="https://www.exploit-db.com/exploits/47774">https://www.exploit-db.com/exploits/47774</a><br>
<a href="https://www.exploit-db.com/exploits/48311">https://www.exploit-db.com/exploits/48311</a>

Which can also be found when you use searchsploit:
<img src="https://private-user-images.githubusercontent.com/58163840/309442179-8ad61324-4df1-4c3c-a76d-463b99c219a3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzktOGFkNjEzMjQtNGRmMS00YzNjLWE3NmQtNDYzYjk5YzIxOWEzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRjNTNhNmYyOTIxZDA0NTE3ZDc5MmUzYzBmMjU2YzNlOGEzMzM5M2EzYWUzZTFlMWQ5ZmVlNjM2ZGE1MDdmZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.cwJjGDSGMsAnPkzY31vby1fdZ-OD7ZiySUvZxFFt82c" name="searchsploit">

Exploiting the directory traversal vulnerability, navigating to Nathan's desktop folder, we then managed to obtain a list of passwords which user Nadine referred to.
<img src="https://private-user-images.githubusercontent.com/58163840/309442161-dc23e910-bd13-408d-8556-cb256d2e09eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjEtZGMyM2U5MTAtYmQxMy00MDhkLTg1NTYtY2IyNTZkMmUwOWViLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZjZjAwMzM1ZjE1YTcxMzU2NmI0OTM0ZmEwZTZmNDUyN2ZlMzgxMTQ4ZmYxYTA1YjZhMjQ5YzI0NTM3MzBlYjImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.hrrbdE7K75JY3wx-wXSQeXAY35UBuQVBQc3kpDDyQ20" name="burpsuite">

Using hydra, we are then able to quickly identify which user uses the list of passwords to access via ssh. The list of users here comprises of the possible list of users, based on the earlier enumeration via FTP, which included Nadine, Nathan and Administrator.
<img src="https://private-user-images.githubusercontent.com/58163840/309442172-52abefb8-a3d9-46c6-93df-5efd514cae50.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzItNTJhYmVmYjgtYTNkOS00NmM2LTkzZGYtNWVmZDUxNGNhZTUwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVhYjczMGJmMTA1YjkwYWMzOWZjMGE3M2U5Y2ZkNTdmOWE0NWUxMGY4YTQ5NTMwM2I4ZTU1M2ZjNTE1M2NmNTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.kvYuhxXKzR2l7YMb_aMsoYYiAbOYM0VrBHPlCV__A6s" name="hydra">

Using ssh, we then obtained user access to user account Nadine, where we can find the user flag at Nadine's desktop folder.

<img src="https://private-user-images.githubusercontent.com/58163840/309442181-9d11af12-2477-4e49-84cd-18b2553e911d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxODEtOWQxMWFmMTItMjQ3Ny00ZTQ5LTg0Y2QtMThiMjU1M2U5MTFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTRkMTAwN2Q5YmIzNDFjM2ZiNjBjODkxNzE2ZjE5YjI0ZGM0Y2IyNzdlNTAxNmJmMzkxZmEyN2E4Nzg2MTA2MGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.HXjDm9GswpUiW0kgAMBZ5Ddb175tl1hnpx5lvDeCd18" name="userssh">

<img src="https://private-user-images.githubusercontent.com/58163840/309442182-8c79e39e-37cd-4746-8206-054446fee195.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTYzNTUsIm5iZiI6MTcwOTM1NjA1NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxODItOGM3OWUzOWUtMzdjZC00NzQ2LTgyMDYtMDU0NDQ2ZmVlMTk1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MDczNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRhZDQwOWI5NjdiMTk1ODhjYzcxNWViNmE5M2VkNmY0YjJmMjRiOWVjYWVmN2ZlOTI0NDMwZDhmM2RlYTJhZTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.uHp6nOlpQ8r3UTeAj2_-iJPIAfX3xm9eA22Xk8O5vAo" name="userssh2">

# Obtaining root
Using winPEAS to enumerate the box, we then found that the system uses NSClient as a monitoring agent for its web server. The particular installed NSClient, has a listed vulnerability indicated at exploitDB.

<img src="https://private-user-images.githubusercontent.com/58163840/309442185-222e0bd7-749b-480f-be31-b984f628f266.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxODUtMjIyZTBiZDctNzQ5Yi00ODBmLWJlMzEtYjk4NGY2MjhmMjY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNiYzY5NzFiMTFlNGEzY2JkMDVlYzNiM2JhYzRmYjMzYjQxYjcwOTRjZjMwMjk4ZGIyMDE3MDBlOGFlYmEyMTAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.BH4ncSb5RUQEtHFXNrtBzM9sQRX37pzEaF2Mvtbtic4" name="winpeas">

<img src="https://private-user-images.githubusercontent.com/58163840/309442180-959ec1b0-dfb1-41ce-9cf3-62f169ada601.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxODAtOTU5ZWMxYjAtZGZiMS00MWNlLTljZjMtNjJmMTY5YWRhNjAxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBhY2Q3NTkwYzllMmJlMDkyNWIwOGY4NmUzZmVlMzViMTEyZTg1ZmE1ZGNmMzA2ZWM2ZmEzNmE0YjNhNDgyZWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.ToMvOJcktcGU7MKnS3At4crBFPFpPonxK5smJZer2Jk" name="searchsploit2">

The installed NSCLient++ 0.5.2.35 is vulnerable to privilege escalation as showed in exploitDB:
<br><a href="https://www.exploit-db.com/exploits/46802">https://www.exploit-db.com/exploits/46802</a>

Following the steps of the exploitation listed in the above website, we first identify the password indicated at nsclient.ini:
<img src="https://private-user-images.githubusercontent.com/58163840/309442176-bff8a52d-0b7d-4a54-be89-701d906962db.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzYtYmZmOGE1MmQtMGI3ZC00YTU0LWJlODktNzAxZDkwNjk2MmRiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY4MjY3NGIzNzkxNDk5OWUwOWU0NTk3M2UxZDI4MDJhMjYxNjk3OTkwNzU1ODM5YzVjNWU0ZTljZThmYTI0YzcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.LvZvbAYgqAnkUj5Irix9yg_CEkJn4j21X1Zpwx6hs28" name="nsclient">

It was also previously identified in winPEAS that there was an internally routed service at port 8443. 
By forwarding the port to our kali, we then identified it to be the NSClient's configuration web panel.

<img src="https://private-user-images.githubusercontent.com/58163840/309442174-fc400da8-b9cb-4d44-b99c-5898baf00d31.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzQtZmM0MDBkYTgtYjljYi00ZDQ0LWI5OWMtNTg5OGJhZjAwZDMxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk0NTdiMzY2NzkxM2YxZTg5MTE4YWU2NWEyZjY1YjcxNmUxZGJiNzlhMjU5NmVhYTMwMDg2YTBiMjE3YzliYmUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Vpazb5xLg1Cd7YQLbzzadD8Z-0TIPhZMg7jsLfxLVsk" name="netstat">

<img src="https://private-user-images.githubusercontent.com/58163840/309442177-376e877e-471b-420c-accf-d79105efd425.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzctMzc2ZTg3N2UtNDcxYi00MjBjLWFjY2YtZDc5MTA1ZWZkNDI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM2ODgzZmI3NTU4NWRjODZlZTFiNmY0OWIzZDA5OWI5MzdjZjk3Mzg3ZWVjYzFhMGU1MTg0ZjdlMzI0Y2Y0NmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.bQS_R-5p_4roO9GLAhcj6O3HMBdUABybksJi93jOCNQ" name="portforward">

<img src="https://private-user-images.githubusercontent.com/58163840/309442184-758a2074-aba4-4dc5-9890-7f2bde306912.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxODQtNzU4YTIwNzQtYWJhNC00ZGM1LTk4OTAtN2YyYmRlMzA2OTEyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTRlYTMwMjllNzM1M2ZjODg0YTFlZjg5M2Y3YTdmNDAzNDQyNjkxNjU3NzAwNGU5NTA5YjAzOThhYzM0ZTFjODkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.BE22bOoem5hL5Ayn9-yVKn__ChviBt96qwa22-DC2OY" name="webui">

However, as there were severe latency in using the web UI to conduct the exploit, we opted to use curl to manipulate the configuration for NSClient.
By creating an exploit.bat file and uploading it into the server as mentioned by the instructions for the exploit, root was obtained. <br>
<img src="https://private-user-images.githubusercontent.com/58163840/309442168-dbbb6021-7cf3-41e3-afa4-949a52943406.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjgtZGJiYjYwMjEtN2NmMy00MWUzLWFmYTQtOTQ5YTUyOTQzNDA2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY2ZGEyNGFlOTViMjM5ZTI5OTFmMTFiOTY0ZDQ3NjA3MmI0Y2FkODRmZjk2YTM2ZmY4MWFlNzc3ODQ2YjI5MTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.oZSn8hQCBQn7Q93ND9MgZ2sWcwT3mrakJrK0nbzPRsg" name="exploit">

Note: the instructions of using api calls can be found here, at NSClient's api documentation: <a href="https://docs.nsclient.org/api/rest/scripts/">https://docs.nsclient.org/api/rest/scripts/</a>

Firstly, we uploaded a netcat executable file into the victim's C:\temp folder. Then we upload the exploit.bat file into the server, as shown below:
<img src="https://private-user-images.githubusercontent.com/58163840/309442163-2289dd6a-0bbb-498a-891f-2af35b41dac4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjMtMjI4OWRkNmEtMGJiYi00OThhLTg5MWYtMmFmMzViNDFkYWM0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3NDk0M2JmNzAzMTM2MTdlNmRhMzEzY2FiZDllYmY2YzQ3YjBiYTUxMmJmZWNmMGEyNmUyODZjMzJhNjE3YTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.14eUojvVCchwPbDvmIj21TlBAnAv6dvbTZN8GGH9WLI" name="curl1">

We can then verify that the file has been successfully uploaded with the following command:

<img src="https://private-user-images.githubusercontent.com/58163840/309442164-bf833aac-ebf0-44f0-b41b-a487c23aba16.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjQtYmY4MzNhYWMtZWJmMC00NGYwLWI0MWItYTQ4N2MyM2FiYTE2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTE0MzgyMTlmZmNiNGE3MmE3YjA5YWYxMTE1OTdjMTEyZjk5ZjU0MjgxNmYyMWIwYjY1ODA3ZDdmZGJhYTkzMGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.W7L14XlpypDPqwckv3b9cY1GmzQxULIalokEFUUY8F4" name="curl2">

<img src="https://private-user-images.githubusercontent.com/58163840/309442165-65715c29-137d-4e2d-a956-48e2a74aedc6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjUtNjU3MTVjMjktMTM3ZC00ZTJkLWE5NTYtNDhlMmE3NGFlZGM2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIxZTdlNTQ2NzQ1NzRkN2Q2YmU3YWZkYWNjNzljODM3NmJmMDQ2Y2I3YWZlMmM5OGNjNGFkMTcyOWFkYzVhN2EmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.U1sQBrbayCZ6thSBA7YdY3-QJEonPItm0gpUHp9Bemo" name="curl3">

We then run the exploit by following the command listed in the api documentation: <a href="https://docs.nsclient.org/api/rest/queries/#command-execute">https://docs.nsclient.org/api/rest/queries/#command-execute</a>
<img src="https://private-user-images.githubusercontent.com/58163840/309442166-c679c2e1-948c-45b5-a4ef-054fc59323fb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTY3OTYsIm5iZiI6MTcwOTM1NjQ5NiwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNjYtYzY3OWMyZTEtOTQ4Yy00NWI1LWE0ZWYtMDU0ZmM1OTMyM2ZiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY1ODdiMGMyMmQxNzIwZjlmY2RjZmRlZWQzNGY4N2ZmYWVhMmQ1M2ZkNGMyOGRjNGYzZjk2MmJkMDE0Nzg4YjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Oh6m8hC1Oy7mpS2f78s9Eyw2lPdlWainzAyquxoW1E8" name="curl4">

With a nc listener waiting on our kali machine, we then obtained NT AUTHORITY\SYSTEM access into the machine:
<img src="https://private-user-images.githubusercontent.com/58163840/309442178-8323708f-0bcc-4816-ae51-2b2364418f72.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkzNTcxNzUsIm5iZiI6MTcwOTM1Njg3NSwicGF0aCI6Ii81ODE2Mzg0MC8zMDk0NDIxNzgtODMyMzcwOGYtMGJjYy00ODE2LWFlNTEtMmIyMzY0NDE4ZjcyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzAyVDA1MjExNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE2ZDVhMDU3NDViNTkzY2MwODRmYmE0NjViNTMyMDM2MGIxNzFiYWE4NGUzZThhM2Q5MTIxZjg1ZTM5ZDlkOTAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.XEo5wIpv6rFPe3fVq73AtG49R0jAf83b9d5HOfZX0HQ" name="reverseshell">


The root flag is then found the root home folder.


                                                                                                                      
                                                                                

